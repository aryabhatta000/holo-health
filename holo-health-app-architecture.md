# Overview

This document presents a high-level view of an _Application Architecture_ that supports the emergence of _**person-centric healthcare ecosystems**_ on top of a _holochain_ based infrastructure. Refer to the [holo-health project README](README.md) for an overview of the project, including its goals and guiding principles.

# High-Level Application Architecture
 The following figure depicts a high-level view of the _Empowered Health Market Application Architecture_. 
![Empowered Health Application Architecture](images/holo-health%20app%20architecture.png)
**_Figure 1. Empowered Health Ecosystem Application Architecture_**

Figure 1 shows four types of _holochain applications_:
* [**_Personal Health Vault hApp (phv)_**](phv/personal-health-vault-hApp.md) -- This hApp is used to store and provide access to my own personal health information. Each person has their own instance of this hApp (and therefore, in holochain terms, their own DHT). All of my devices can join this hApp, making my health information accessible from any of my devices. I can also choose to allow close friends or family members to join so that, in the event I am incapacitated, they can authorize healthcare providers to access my health-data. The _phv_ consists of _HealthCards_ that record _health observations_, _care plans_, _medication records_, _diagnostic reports_, etc. _HealthCards_ will leverage industry standards for terminology (e.g., [LOINC](https://loinc.org) and [SNOMED CT](https://www.snomed.org)) and interoperability (e.g., [FHIR](https://www.hl7.org/fhir/resourcelist.html)). A HealthCard can be _self-reported_, captured from a _personal health device_ (e.g., health bracelet, smart watch), or the result of a service provided by a _Healthcare Provider_ (e.g., an examination, lab-test, prescription order, surgery result, etc.). Over time, the collection of _HealthCards_ provide a comprehensive _Personal Health Record_ that is completely under my control. _(NOTE: The initial Proof of Concept (PoC) will only support a very simplistic implementation of HealthCards.)_
* [_**Health Market hApp (hm)**_](hm/healthcare-market-hApp.md) -- This hApp provides a _public marketplace_ where _Health Care Providers_ can _**offer**_ healthcare services. Each _offer_ specifies the _terms_ under which people can avail themselves of that service. These _terms_ can include a list of the exact types of _personal health observations_ the _Healthcare Provider_ may need in order to deliver the service.  As a trivial example, the _offer_ for an _Activity Recommendations Service_ could specify that it will recommend the number of _daily steps_ a person should take, provided they are willing to share their _age_, _weight_, and _gender_. Each Marketplace instance (DHT) can specify a set of principles that all providers in that marketplace are committed to following (enforced by the _membrane function_ that allows agents to join the marketplace). Example principles could include, for example, a commitment to pro-active, person-centric healthcare, a commitment to not share information with any outside agent without explicit permission from the consumer, etc. It is up to each _healthcare provider_ to decide what principles they are willing to publicly commit to following. Potential healthcare consumers can search for marketplaces whose principles align with their personal values and then search within that marketplace for services they feel may benefit them. If they find an _offer_ for a _service_ they want under _acceptable terms_, they can choose to _accept_ the _offer_.  
* [_**Health Service Delivery hApp (hsd)**_](hsd/healthcare-service-delivery-hApp.md) -- _Accepting_ an offer results in a new instance of the _Health Service Delivery hApp_ being created for which only the person who accepted the offer and the Healthcare Provider that posted the offer are added as members. The _hsd_ serves as a private channel between the two parties. Both the _agreement_ (which includes a reference to the _offer_ on which the _agreement_ was based) and the _requests_ and _responses_ made by either party, are recorded in the DHT for this hApp instance. The hApp will automatically check all _requests_ by a _Healthcare Provider_  for _Personal Health Information_. If any type of information is requested that does not conform to the types of information listed in the _offer_ bound to the _agreement_ for this _hsd_ hApp instance, the request is  automatically rejected (and both the _response_ and the _rejection_ recorded in the _hsd's_ DHT). Otherwise, the requested information is retrieved from the _Personal Health Record_ and returned to the provider. The provider can then analyze the retrieved information and make a _recommendation_ back to the person. This _recommendation_ is itself an _observation_ that may be recorded in the person's _Personal Health Record_. Signing the result into the _Personal Health Record_ can then trigger the reciprocal value return (e.g., payment for the service). Recording all _requests_ and _responses_ in the DHT provides a non-forgeable, immutable, non-repudiable audit trail. This audit trail is required for both invoicing and regulatory compliance. Ideally, this can also be leveraged to address a key barrier to PHR adoption by allowing clear provenance and data integrity to be established for the health card. Health care practitioners (e.g., physicians) are reluctant to trust health records that have been in patient custody out of concern the record may be incomplete or have been altered. Because the _hsd_ stores each _HealthCard_ in an immutable, non-forgeable and non-repudiable way, healthcare practitioners can be confident that the observation or diagnostic report is complete and unchanged. However, see [Issue #2](https://github.com/evomimic/holo-health/issues/2).
* _**Provider hApp (hp)**_ -- This type of hApp is intended to provide a _holochain-native application_ for use by _Healthcare Providers_. It is included for completeness and to indicate a potential future direction. However, use of such an hApp is NOT a pre-requisite for a _Healthcare Provider_ to participate in the _Empowered Health Ecosystem_. It is expected that most _providers_ already have their own _Electronic Medical Record_ (EMR) or _Electronic Health Record_ (EHR) systems. To require them to adopt a pure _holochain-native_ application architecture for their internal systems would pose a significant barrier to entry into the _Empowered Health Ecosystem_. Instead, an API-based approach will be followed initially. To participate in the _Empowered Health Ecosystem_, _Healthcare Providers_ will need to provision some _nodes_ that are configured to _join_ _Health Market_ and/or _Health Service Delivery_ hApp instances. Mapping to/from the _Healthcare Providers_ internal systems and the _holo-health_ applications will be the _Healthcare Providers_ responsibility.  

It is worth noting that this _application architecture_ enables better health outcomes, because the PHR provides a much more holistic and complete view of the patient's medical history, (since it includes information from multiple providers). Furthermore, it creates possibilities for profoundly different information sharing ecosystems. Consider, for example, that, **under the right _agreements_, _healthcare providers_ need never persistently store _Electronic Medical Records_ about individuals in their own internal systems**. Instead they can retrieve information about a patient from the patient's own _PHR_ whenever needed to, say, make a diagnosis, issue a medication order, etc. Not storing such information (which is considered _Protected Health Information_ -- _PHI_ -- in HIPAA/HITECH regulations) in their own systems represents a huge reduction in the risk of data exposure which can translate to significant cost-savings. 
